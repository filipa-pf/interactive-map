<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mapa Interativo de Portugal</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body {
    margin: 0;
    font-family: sans-serif;
  }
  .container {
    display: flex;
    height: 800px; /* altura total do mapa + coluna */
  }
  #map {
    flex: 2; /* ocupa 2/3 da largura */
  }
  #info {
    flex: 1; /* ocupa 1/3 da largura */
    padding: 20px;
    border-left: 1px solid #ccc;
    overflow-y: auto;
  }
  .concelho:hover { 
    fill: #faa !important; 
    cursor: pointer; 
  }
</style>
</head>
<body>

<div class="container">
  <div id="map"></div>
  <div id="info">
    <h2>Informações</h2>
    <p>Clique num concelho para ver detalhes aqui.</p>
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map', {
    zoomControl: true,
    attributionControl: false
  }).setView([39.5, -8], 7);

  // Carregar GeoJSON
  fetch('concelhos.json')
  .then(res => res.json())
  .then(data => {

    // Função para mover e escalar ilhas
    function moveIsland(feature, dx, dy, scale = 1) {
      feature.geometry.coordinates = feature.geometry.coordinates.map(polygon => {
        return polygon.map(ring => {
          return ring.map(([lon, lat]) => [lon * scale + dx, lat * scale + dy]);
        });
      });
      return feature;
    }

    // Percorre os features e ajusta as ilhas
    data.features = data.features.map(feature => {
      const name = feature.properties.name;
      if (name === "Madeira") {
        return moveIsland(feature, -10, -32, 5); // exemplo de deslocamento e escala
      }
      if (name === "Açores") {
        return moveIsland(feature, -15, -15, 4); // exemplo de deslocamento e escala
      }
      return feature;
    });

    // Adiciona o GeoJSON ajustado ao mapa
    L.geoJSON(data, {
      style: () => ({ color: '#556', weight: 1, fillColor: '#ccc', fillOpacity: 0.6 }),
      onEachFeature: (feature, layer) => {
        layer.on('click', () => {
          const nome = feature.properties.name;
          if (confirm(`Pretende contactar o autarca de ${nome}?`)) {
            alert('Contacto em construção.');
          }
        });
      }
    }).addTo(map);

  })
  .catch(err => console.error('Erro ao carregar concelhos.json:', err));
</script>

</body>
</html>
